<nb-card class="card-single-page-height" [formGroup]="fullForm.group">
  <nb-card-header class="card-header-shadow">
    <cais-card-header
      [label]="'Лица'"
      [onCancelFunction]=""
      [setForPreview]="true"
    >
      <div>
        <button
          nbButton
          matRipple
          [status]="'success'"
          (click)="onSearch()"
          type="button"
          class="ml-2"
          style="min-width: 100px"
        >
          Търсене
        </button>
      </div>
    </cais-card-header>
  </nb-card-header>
  <nb-card-body class="overflow-scroll" style="min-height: 500px;">
    <form autocomplete="off">
      <div class="row">
        <div class="form-group col-md-3">
          <cais-input
            [type]="'text'"
            [label]="'ЕГН'"
            [inputFormControl]="fullForm.identifier"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
        <div class="form-group col-md-6">
          <cais-date-precision [formModel]="fullForm.birthDate">
          </cais-date-precision>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-md-3">
          <cais-input
            [type]="'text'"
            [label]="'Име'"
            [inputFormControl]="fullForm.firstName"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
        <div class="form-group col-md-3">
          <cais-input
            [type]="'text'"
            [label]="'Презиме'"
            [inputFormControl]="fullForm.surName"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
        <div class="form-group col-md-3">
          <cais-input
            [type]="'text'"
            [label]="'Фамилия'"
            [inputFormControl]="fullForm.familyName"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
        <div class="form-group col-md-3">
          <cais-input
            [type]="'text'"
            [label]="'Пълно име'"
            [inputFormControl]="fullForm.fullName"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
      </div>
    </form>

    <igx-grid
      #grid
      igxGridState
      [data]="items$ | async"
      [height]="null"
      [filterStrategy]="noopFilterStrategy"
      [sortStrategy]="noopSortStrategy"
      [paging]="true"
      [clipboardOptions]="{ copyHeaders: false }"
      [displayDensity]="'cosy'"
      (onSortingDone)="sortingDone($event)"
      (onFilteringDone)="filteringDone($event)"
      (onSelection)="cellSelection($event)"
      [paginationTemplate]="pager"
      [allowFiltering]="false"
      [primaryKey]="'id'"
      [pinning]="pinningConfig"
      [cellSelection]="'none'"
    >
      <igx-grid-toolbar>
        <igx-grid-toolbar-title>Лица</igx-grid-toolbar-title>
      </igx-grid-toolbar>

      <igx-column
        field="id"
        header="Идентификатор"
        [sortable]="true"
        [dataType]="'string'"
        [hidden]="true"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>

      <igx-column
        field="identifier"
        header="ЕГН/ЛНЧ/ЛН"
        [sortable]="true"
        [dataType]="'string'"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>

      <igx-column
        field="firstName"
        header="Име"
        [sortable]="true"
        [dataType]="'string'"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>
      <igx-column
        field="surName"
        header="Презиме"
        [sortable]="true"
        [dataType]="'string'"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>
      <igx-column
        field="familyName"
        header="Фамилия"
        [sortable]="true"
        [dataType]="'string'"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>
      <igx-column
        field="fullName"
        header="Пълно име"
        [sortable]="true"
        [dataType]="'string'"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="cell.value">{{ cell.value }}</span>
        </ng-template>
      </igx-column>
      <igx-column
        field="birthDate"
        [sortable]="true"
        header="Дата на раждане"
        dataType="Date"
        [formatter]="this.dateFormatService.formatDate"
      >
        <ng-template igxCell let-cell="cell">
          <span [title]="this.dateFormatService.displayDate(cell.value)">
            {{ this.dateFormatService.displayDate(cell.value) }}
          </span>
        </ng-template>
      </igx-column>

      <igx-column
        width="150px"
        header=""
        [sortable]="false"
        [filterable]="false"
        [pinned]="true"
      >
        <ng-template igxCell let-cell="cell"> </ng-template>
      </igx-column>

      <ng-template #pager let-grid>
        <div class="tl-paginator">
          <cais-grid-pager
            [page]="remoteService.pagerParams.page"
            [perPage]="remoteService.pagerParams.perPage"
            [totalCount]="remoteService.pagerParams.totalCount"
            (pagerChange)="pagerChange($event)"
          ></cais-grid-pager>
        </div>
      </ng-template>
    </igx-grid>
  </nb-card-body>
</nb-card>
