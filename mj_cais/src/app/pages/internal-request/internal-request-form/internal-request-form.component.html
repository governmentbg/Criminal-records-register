<nb-card class="card-single-page-height" [formGroup]="fullForm.group">
  <nb-card-header class="card-header-shadow">
    <cais-card-header
      [label]="this.title"
      [onSaveFunction]="submitFunction"
      [onCancelFunction]="globalCancelFunction"
      [setForPreview]="isForPreview"
    >
      <div>
        <button
          *ngIf="
            !this.isForPreview &&
            requestStatusCode == InternalRequestStatusCodeConstants.Draft
          "
          nbButton
          matRipple
          [status]="'success'"
          (click)="send()"
          type="button"
          class="ml-2"
          style="min-width: 100px"
        >
          Изпрати
        </button>
      </div>
      <ng-container *ngIf="showReplayBtn">
        <div>
          <button
            nbButton
            matRipple
            [status]="'success'"
            (click)="replay(true)"
            type="button"
            class="ml-2"
            style="min-width: 100px"
          >
            Обработена заявка
          </button>
          <button
            nbButton
            matRipple
            [status]="'danger'"
            (click)="replay(false)"
            type="button"
            class="ml-2"
            style="min-width: 100px"
          >
            Отказана заявка
          </button>
        </div>
      </ng-container>
    </cais-card-header>
  </nb-card-header>
  <nb-card-body class="overflow-scroll">
    <form autocomplete="off">
      <div class="row mt-2">
        <div class="form-group col-md-4">
          <cais-autocomplete
            [label]="'До Бюро съдимост'"
            [inputFormControl]="fullForm.toAuthorityId"
            [parentGroup]="fullForm.group"
            [inputName]="'toAuthorityId'"
            [items]="dbData.csAuthorities"
          ></cais-autocomplete>
        </div>
        <div class="form-group col-md-4">
          <cais-input
            [type]="'date'"
            [label]="'Датата на създаване'"
            [inputFormControl]="fullForm.requestDate"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
        <div class="form-group col-md-4">
          <cais-input
            [type]="'text'"
            [label]="'Регистрационен номер'"
            [inputFormControl]="fullForm.regNumberDisplay"
            [parentGroup]="fullForm.group"
          ></cais-input>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-md-4">
          <cais-autocomplete
            [label]="'Тип на заявка'"
            [inputFormControl]="fullForm.nIntReqTypeId"
            [parentGroup]="fullForm.group"
            [inputName]="'nIntReqTypeId'"
            [items]="dbData.requestTypes"
          ></cais-autocomplete>
        </div>
        <div class="form-group col-md-4">
          <cais-lookup
            [label]="'Лице'"
            [inputControl]="fullForm.pPersIdId"
            [parentGroup]="fullForm.pPersIdId.group"
            [openFunction]="openPidDialog"
          ></cais-lookup>
        </div>
      </div>

      <div class="row">
        <div class="form-group col-md-6">
          <cais-input
            [type]="'text'"
            [label]="'Описание'"
            [inputFormControl]="fullForm.description"
            [parentGroup]="fullForm.group"
            [inputType]="InputTypeConstants.TextArea"
          ></cais-input>
        </div>
      </div>
      <ng-container
        *ngIf="isEdit() && requestStatusCode != InternalRequestStatusCodeConstants.Draft"
      >
        <div class="row">
          <div class="form-group col-md-6">
            <cais-input
              [type]="'text'"
              [label]="'Отговор'"
              [inputFormControl]="fullForm.responseDescr"
              [parentGroup]="fullForm.group"
              [inputType]="InputTypeConstants.TextArea"
            ></cais-input>
          </div>
        </div>
      </ng-container>
    </form>
  </nb-card-body>
</nb-card>
