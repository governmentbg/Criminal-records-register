<nb-card class="card-single-page-height" [formGroup]="fullForm.group">
  <nb-card-header class="card-header-shadow">
    <cais-card-header [label]="displayTitle" [onSaveFunction]="submitFunction"
      [onCancelFunction]="globalCancelFunction"></cais-card-header>
  </nb-card-header>
  <nb-card-body class="overflow-scroll">
    <form autocomplete="off">
      <nb-tabset>
        <nb-tab tabTitle="Данни за лицето">
          <div class="row">
            <label class="label label-front col-md-2">Имена на кирилица</label>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.firstname" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.surname" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.familyname" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
          </div>

          <div class="row">
            <label class="label label-front col-md-2">Имена на латиница</label>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.firstnameLat" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.surnameLat" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [inputFormControl]="fullForm.familynameLat" [parentGroup]="fullForm.group">
              </cais-input>
            </div>
          </div>

          <div class="font-weight-bold">
            Псевдоним или други използвани имена на осъденото лице
          </div>
          <hr />

          <div class="row">
            <label class="label label-front col-md-2">Псевдоним</label>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
          </div>

          <div class="row">
            <label class="label label-front col-md-2">Моминско име</label>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
            <div class="form-group col-md-3">
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Пол'" [inputFormControl]="fullForm.sex" [parentGroup]="fullForm.group"
                [inputName]="'sex'" [items]="dbData.genderTypes"></cais-autocomplete>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'date'" [label]="'Дата на раждане'" [inputFormControl]="fullForm.birthDate"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'ЕГН'" [inputFormControl]="fullForm.egn"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'ЛН'" [inputFormControl]="fullForm.ln"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'ЛНЧ'" [inputFormControl]="fullForm.lnch"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3">
              <label class="label">Националност</label>
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'АФИС номер'" [inputFormControl]="fullForm.afisNumber"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="font-weight-bold">Документ за самоличност</div>
          <hr />

          <div class="row">
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Номер на документ'" [inputFormControl]="fullForm.idDocNumber"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Категория'" [inputFormControl]="fullForm.idDocCategoryId"
                [parentGroup]="fullForm.group" [inputName]="'idDocCategoryId'" [items]="dbData.idDocumentCategoryTypes">
              </cais-autocomplete>
            </div>
            <div class="form-group col-md-6">
              <cais-input [type]="'text'" [label]="'Друга категория в случай че липсва в списъка'"
                [inputFormControl]="fullForm.idDocTypeDescr" [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Издаващ орган'" [inputFormControl]="fullForm.idDocIssuingAuthority"
                [parentGroup]="fullForm.group" [inputName]="'idDocIssuingAuthority'"
                [items]="dbData.idDocIssuingAuthorities"></cais-autocomplete>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'date'" [label]="'Дата на издаване'" [inputFormControl]="fullForm.idDocIssuingDate"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'date'" [label]="'Дата на валидност'" [inputFormControl]="fullForm.idDocValidDate"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="font-weight-bold">Родители</div>
          <hr />

          <div class="row">
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Майка - име'" [inputFormControl]="fullForm.motherFirstname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Майка - презиме'" [inputFormControl]="fullForm.motherSurname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Майка - фамилия'" [inputFormControl]="fullForm.motherFamilyname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <label class="label">Майка - Дата на раждане</label>
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Баща - име'" [inputFormControl]="fullForm.fatherFirstname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Баща - презиме'" [inputFormControl]="fullForm.fatherSurname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Баща - фамилия'" [inputFormControl]="fullForm.fatherFamilyname"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <label class="label">Баща - Дата на раждане</label>
              <input type="text" nbInput fullWidth value="N/A" />
            </div>
          </div>
        </nb-tab>

        <nb-tab tabTitle="Осъждане">
          <div class="font-weight-bold">Данни за акта</div>
          <hr />

          <div class="row">
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Вид на акта'" [inputFormControl]="fullForm.decisionTypeId"
                [parentGroup]="fullForm.group" [inputName]="'decisionTypeId'" [items]="dbData.decisionTypes">
              </cais-autocomplete>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Номер на акта'" [inputFormControl]="fullForm.decisionNumber"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'date'" [label]="'Дата на акта'" [inputFormControl]="fullForm.decisionDate"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'date'" [label]="'Дата на влизане в сила'"
                [inputFormControl]="fullForm.decisionFinalDate" [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Съдебен орган издал акта'" [inputFormControl]="fullForm.decidingAuthId"
                [parentGroup]="fullForm.group" [inputName]="'decidingAuthId'" [items]="dbData.decidingAuthorities">
              </cais-autocomplete>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'ECLI номер'" [inputFormControl]="fullForm.decisionEcli"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="font-weight-bold">Данни за делото</div>
          <hr />

          <div class="row">
            <div class="form-group col-md-3">
              <cais-autocomplete [label]="'Вид дело'" [inputFormControl]="fullForm.caseTypeId"
                [parentGroup]="fullForm.group" [inputName]="'caseTypeId'" [items]="dbData.caseTypes">
              </cais-autocomplete>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Номер на делото'" [inputFormControl]="fullForm.caseNumber"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
            <div class="form-group col-md-3">
              <cais-input [type]="'text'" [label]="'Година на делото'" [inputFormControl]="fullForm.caseYear"
                [parentGroup]="fullForm.group"></cais-input>
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-9">
              <cais-input [type]="'text'" [label]="'Забележки'" [inputFormControl]="fullForm.convRemarks"
                [parentGroup]="fullForm.group" [inputType]="InputTypeConstants.TextArea"></cais-input>
            </div>
          </div>
        </nb-tab>

        <nb-tab tabTitle="Престъпление">
          <app-grid-with-transactions [gridTransactions]="fullForm.offancesTransactions">
            <igx-grid #offencesGrid #deliveryPropertiesGrid [height]="null" [data]="dbData.offences"
              [primaryKey]="'id'">
              <igx-grid-toolbar>
                <button igxButton="flat" (click)="dialogAdd.open()" *ngIf="!isForPreview" class="addProdBtn">
                  <igx-icon>add</igx-icon> Добави
                </button>
              </igx-grid-toolbar>

              <igx-column field="id" header="Идентификатор" [sortable]="false" [dataType]="'string'" [hidden]="true">
              </igx-column>
              <igx-column field="offenceCatId" header="Код-националносто право" [sortable]="true" [dataType]="'string'">
                <ng-template igxCell let-cell="cell">
                  {{ getOffenceCategoryNameByValue(cell.value) }}
                </ng-template>
              </igx-column>
              <igx-column field="formOfGuilt" header="Форма на вината" [sortable]="true" [dataType]="'string'">
              </igx-column>
              <igx-column field="ecrisOffCatId" header="Обща категория" [sortable]="true" [dataType]="'string'">
                <ng-template igxCell let-cell="cell">
                  {{ getEcrisOffCatNameByValue(cell.value) }}
                </ng-template>
              </igx-column>
              <igx-column field="offStartDate" [sortable]="true" header="Начална дата на извършване на деянието"
                dataType="Date" [formatter]="this.dateFormatService.formatDate">
                <ng-template igxCell let-cell="cell">
                  <span [title]="this.dateFormatService.displayDateTime(cell.value)">
                    {{ this.dateFormatService.displayDateTime(cell.value) }}
                  </span>
                </ng-template>
              </igx-column>
              <igx-column field="offEndDate" [sortable]="true" header="Крайна дата на извършване на деянието"
                dataType="Date" [formatter]="this.dateFormatService.formatDate">
                <ng-template igxCell let-cell="cell">
                  <span [title]="this.dateFormatService.displayDateTime(cell.value)">
                    {{ this.dateFormatService.displayDateTime(cell.value) }}
                  </span>
                </ng-template>
              </igx-column>
              <igx-action-strip #actionstrip>
                <button title="Редактирай" igxButton="icon" igxRipple
                  (click)="onOpenEditBulletinOffence(actionstrip.context)">
                  <igx-icon>edit</igx-icon>
                </button>
                <button title="Изтрии" igxButton="icon" igxRipple
                  (click)="onDeleteBulletinOffence(actionstrip.context)">
                  <igx-icon>delete</igx-icon>
                </button>
              </igx-action-strip>
            </igx-grid>
          </app-grid-with-transactions>
          <igx-dialog #dialogAdd>
            <div class="dialogNewRecord" style="min-width: 1000px">
              <nb-card>
                <nb-card-header>
                  <div class="d-flex" style="justify-content: space-between">
                    <div class="d-flex align-items-center">
                      <h5 style="font-weight: bold">Престъпление</h5>
                    </div>
                    <div class="d-flex">
                      <div>
                        <button nbButton matRipple [status]="'success'" (click)="onAddOrUpdateBulletineOffenceRow()"
                          type="button" class="ml-2">
                          Потвърди
                        </button>
                      </div>
                      <div>
                        <button nbButton matRipple (click)="onCloseBulletinOffenceDilog()" type="button" class="ml-2">
                          Откажи
                        </button>
                      </div>
                    </div>
                  </div>
                </nb-card-header>
                <nb-card-body>
                  <div class="row mt-2">
                    <div class="form-group col-md-8">
                      <cais-autocomplete [label]="'Код-националното право'" [inputFormControl]="
                            bulletinOffenceForm.offenceCatId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.offencesCategories" [inputName]="'offenceCatId'">
                      </cais-autocomplete>
                    </div>
                    <div class="form-group col-md-4">
                      <cais-input [type]="'text'" [label]="'Форма на вината'" [inputFormControl]="
                        bulletinOffenceForm.formOfGuilt
                        " [parentGroup]="bulletinOffenceForm.group" [inputName]="'formOfGuilt'"></cais-input>
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-md-12">
                      <cais-input [type]="'text'" [label]="'Описание на деянието'" [inputFormControl]="
                        bulletinOffenceForm.remarks" [parentGroup]="bulletinOffenceForm.group" [inputName]="'remarks'"
                        [rows]="'3'" [inputType]="InputTypeConstants.TextArea">
                      </cais-input>
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-md-8">
                      <cais-autocomplete [label]="'Обща категория'" [inputFormControl]="
                    bulletinOffenceForm.ecrisOffCatId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.ecrisOffCategories" [inputName]="'ecrisOffCatId'">
                      </cais-autocomplete>
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-md-12">
                      <cais-input [type]="'text'" [rows]="'3'" [label]="'Правна квалификация'" [inputFormControl]="
                        bulletinOffenceForm.remarks" [parentGroup]="bulletinOffenceForm.group" [inputName]="'remarks'"
                        [inputType]="InputTypeConstants.TextArea">
                      </cais-input>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="form-group col-md-4">
                      <cais-input [type]="'date'" [label]="'Начална дата на извършване на деянието'" [inputFormControl]="
                        bulletinOffenceForm.offStartDate
                        " [parentGroup]="bulletinOffenceForm.group" [inputName]="'offStartDate'"></cais-input>
                    </div>
                    <div class="form-group col-md-4">
                      <cais-input [type]="'date'" [label]="'Крайна дата на извършване на деянието'" [inputFormControl]="
                        bulletinOffenceForm.offEndDate
                        " [parentGroup]="bulletinOffenceForm.group" [inputName]="'offEndDate'"></cais-input>
                    </div>
                  </div>
                  <div class="row col-md-12 mb-2">Място на извършване на престъплението</div>
                  <div class="row ml-2">
                    <div class="form-group col-md-4 ">
                      <cais-autocomplete [label]="'Държава'" [inputFormControl]="
                    bulletinOffenceForm.offPlaceCountryId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.countries" [inputName]="'offPlaceCountryId'">
                      </cais-autocomplete>
                    </div>
                    <div class="form-group col-md-4">
                      <cais-autocomplete [label]="'Област'" [inputFormControl]="
                    bulletinOffenceForm.offPlaceSubdivId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.countriesSubdivisions" [inputName]="'offPlaceSubdivId'">
                      </cais-autocomplete>
                    </div>
                    <div class="form-group col-md-4">
                      <cais-autocomplete [label]="'Град'" [inputFormControl]="
                    bulletinOffenceForm.offPlaceCityId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.cities" [inputName]="'offPlaceCityId'">
                      </cais-autocomplete>
                    </div>
                  </div>
                  <div class="row ml-2">
                    <div class="form-group col-md-12">
                      <cais-input [type]="'text'" [rows]="'3'" [label]="'Описание'" [inputFormControl]="
                        bulletinOffenceForm.offPlaceDescr" [parentGroup]="bulletinOffenceForm.group"
                        [inputName]="'offPlaceDescr'" [inputType]="InputTypeConstants.TextArea">
                      </cais-input>
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group col-md-8">
                      <cais-input [label]="'Колко пъти е извършено'" [inputFormControl]="
                        bulletinOffenceForm.occurrences" [parentGroup]="bulletinOffenceForm.group"
                        [inputName]="'occurrences'"
                        >
                      </cais-input>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-5">
                      <div class="nb-form-control-container" style="
                          height: 40px;
                          max-width: 100%;
                          display: flex;
                          align-items: center;
                        ">
                        <nb-checkbox [formControl]="bulletinOffenceForm.isContiniuous">Непрекъснато извършвано
                          престъпление</nb-checkbox>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="nb-form-control-container" style="
                          height: 40px;
                          max-width: 100%;
                          display: flex;
                          align-items: center;
                        ">
                        <nb-checkbox [formControl]="bulletinOffenceForm.respExemption">Освобождаване от наказателна
                          отговорност</nb-checkbox>
                      </div>
                    </div>
                    <div class="col-md-2">
                      <div class="nb-form-control-container" style="
                          height: 40px;
                          max-width: 100%;
                          display: flex;
                          align-items: center;
                        ">
                        <nb-checkbox [formControl]="bulletinOffenceForm.recidivism">Рецидивизъм
                        </nb-checkbox>
                      </div>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="form-group col-md-4 ">
                      <cais-autocomplete [label]="'Степен на довършване'" [inputFormControl]="
                    bulletinOffenceForm.offLvlComplId" [parentGroup]="bulletinOffenceForm.group"
                        [items]="dbData.completions" [inputName]="'offLvlComplId'">
                      </cais-autocomplete>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="form-group col-md-4">
                      <cais-autocomplete [label]="'Степен на участие'" [inputFormControl]="
                    bulletinOffenceForm.offLvlPartId" [parentGroup]="bulletinOffenceForm.group" [items]="dbData.parts"
                        [inputName]="'offLvlPartId'">
                      </cais-autocomplete>
                    </div>
                  </div>
                </nb-card-body>
              </nb-card>
            </div>
          </igx-dialog>
        </nb-tab>

        <nb-tab tabTitle="Наказание">
          <span>Content #4</span>
        </nb-tab>

        <nb-tab tabTitle="Доп. сведения">
          <span>Content #5</span>
        </nb-tab>

        <nb-tab tabTitle="Служ. информация">
          <span>Content #6</span>
        </nb-tab>

        <nb-tab tabTitle="Уведомления">
          <span>Content #7</span>
        </nb-tab>

        <nb-tab tabTitle="Документи">
          <span>Content #8</span>
        </nb-tab>

        <nb-tab tabTitle="Одит">
          <span>Content #9</span>
        </nb-tab>
      </nb-tabset>
    </form>
  </nb-card-body>
</nb-card>