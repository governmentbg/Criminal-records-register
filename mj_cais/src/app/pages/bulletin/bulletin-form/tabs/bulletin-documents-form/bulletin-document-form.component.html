<igx-grid #documentsGrid [height]="null" [data]="documents" [primaryKey]="'id'">
  <igx-grid-toolbar>
    <igx-grid-toolbar-actions>
      <div class="ml-auto">
        <button
          *ngIf="showAddDeleteButton"
          nbButton
          matRipple
          [status]="'success'"
          (click)="onOpenDialog(); dialogAdd.open()"
        >
          Добави &nbsp;
          <i class="fa fa-plus" aria-hidden="true"></i>
        </button>
      </div>
    </igx-grid-toolbar-actions>
  </igx-grid-toolbar>
  <igx-column
    field="id"
    header="Идентификатор"
    [sortable]="false"
    [dataType]="'string'"
    [hidden]="true"
  >
  </igx-column>
  <igx-column
    field="name"
    header="Наименование"
    [sortable]="true"
    [dataType]="'string'"
  ></igx-column>
  <igx-column
    field="descr"
    header="Описание"
    [sortable]="true"
    [dataType]="'string'"
  ></igx-column>

  <igx-column
    field="docTypeId"
    header="Идентификатор на вид документ"
    dataType="number"
    [hidden]="true"
  >
  </igx-column>
  <igx-column
    field="docTypeName"
    header="Вид документ"
    [sortable]="true"
    [dataType]="'string'"
  ></igx-column>

  <igx-column
    width="100px"
    header="Действия"
    [sortable]="false"
    [filterable]="false"
  >
    <ng-template igxCell let-cell="cell">
      <button
        igxButton="icon"
        [title]="'Изтегляне'"
        (click)="download(cell.rowData.id)"
      >
        <nb-icon pack="fa" icon="download"></nb-icon>
      </button>

      <button
        *ngIf="showAddDeleteButton"
        igxButton="icon"
        [title]="'Изтриване'"
        (click)="openDeleteConfirmationDialog(cell.rowData.id)"
      >
        <nb-icon pack="fa" icon="trash"></nb-icon>
      </button>
    </ng-template>
  </igx-column>
</igx-grid>
<igx-dialog #dialogAdd>
  <div class="dialogNewRecord" style="min-width: 1000px">
    <nb-card>
      <nb-card-header>
        <div class="d-flex" style="justify-content: space-between">
          <div class="d-flex align-items-center">
            <h5 style="font-weight: bold">Документ</h5>
          </div>

          <div class="d-flex">
            <div>
              <button
                nbButton
                matRipple
                status="success"
                (click)="onSubmitBulletineDocument()"
              >
                Потвърди
              </button>
              <button
                nbButton
                matRipple
                (click)="onCloseBulletinDocumentDilog()"
                class="ml-3"
              >
                Откажи
              </button>
            </div>
          </div>
        </div>
      </nb-card-header>
      <nb-card-body>
        <div class="row mt-2">
          <div class="form-group col-md-12">
            <div
              *ngIf="uploader.queue && uploader.queue.length == 0"
              class="bg-light p-2 rounded"
            >
              <strong class="mr-1">Избор на файл</strong>
              <span
                style="
                  visibility: hidden;
                  position: absolute;
                  overflow: hidden;
                  width: 0px;
                  height: 0px;
                  border: none;
                  margin: 0;
                  padding: 0;
                "
                ><input
                  type="file"
                  ng2FileSelect
                  [uploader]="uploader"
                  #fileInput
              /></span>

              <div
                ng2FileDrop
                [ngClass]="{ 'file-over-class': hasDropZoneOver }"
                (fileOver)="fileOverAnother($event)"
                [uploader]="uploader"
                class="well file-drop-zone"
              >
                <button
                  nbButton
                  [status]="'success'"
                  (click)="fileInput.click()"
                  class="mr-2"
                >
                  Изберете
                </button>
                или преместете с мишката файл за да го качите
              </div>
            </div>

            <div
              *ngFor="let item of uploader.queue"
              class="bg-light p-2 rounded"
            >
              <strong>Избран файл: </strong>
              <span class="mr-1">{{ item?.file?.name }}</span>

              <button
                #removeDocBtn
                nbButton
                matRipple
                [status]="'danger'"
                (click)="onRmoveDocument(item)"
              >
                Премахване &nbsp;
                <i class="fa fa-trash" aria-hidden="true"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="row mt-2">
          <div class="form-group col-md-8">
            <cais-autocomplete
              [label]="'Вид документ'"
              [inputFormControl]="bulletinDocumentForm.docTypeId"
              [parentGroup]="bulletinDocumentForm.group"
              [items]="dbData.documentTypes"
              [inputName]="'docTypeId'"
            >
            </cais-autocomplete>
          </div>
        </div>

        <div class="row">
          <div class="form-group col-md-12">
            <cais-input
              [type]="'text'"
              [label]="'Описание'"
              [inputFormControl]="bulletinDocumentForm.descr"
              [parentGroup]="bulletinDocumentForm.group"
              [inputName]="'descr'"
              [rows]="'3'"
              [inputType]="'TextArea'"
            >
            </cais-input>
          </div>
        </div>

        <div class="font-weight-bold">Данни за лице</div>
        <hr />
        <div class="row">
          <div class="col-md-4">
            <label class="label">Имена на кирилица</label>
            <div class="form-group display-input-container">
              <span>
                {{ bulletinInfo.firstname }}
              </span>
              <span>
                {{ bulletinInfo.surname }}
              </span>
              <span>
                {{ bulletinInfo.familyname }}
              </span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Имена на латиница</label>
            <div class="form-group display-input-container">
              <span>
                {{ bulletinInfo.firstnameLat }}
              </span>
              <span>
                {{ bulletinInfo.surnameLat }}
              </span>
              <span>
                {{ bulletinInfo.familynameLat }}
              </span>
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Псевдоним</label>
            <div class="form-group display-input-container">
              <span> N/A</span>
              <span> N/A</span>
              <span> N/A</span>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <label class="label">Пол</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.sex }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Дата на раждане</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.birthDate }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Националност</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <label class="label">ЕГН</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.egn }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">ЛНЧ</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.lnch }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">ЛН</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.ln }}
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <label class="label">Държава</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
          <div class="col-md-4">
            <label class="label">Област</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
          <div class="col-md-4">
            <label class="label">Населено място</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">
            <label class="label">Майка</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
          <div class="col-md-4">
            <label class="label">Баща</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
          <div class="col-md-4">
            <label class="label">БС по местоположение</label>
            <div class="form-group display-input-container">N/A</div>
          </div>
        </div>

        <div class="font-weight-bold">Данни за бюлетин</div>
        <hr />

        <div class="row">
          <div class="col-md-4">
            <label class="label">Дата на регистрация</label>
            <div class="form-group display-input-container">
              N/A
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Номер</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.registrationNumber }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Вид</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.decisionTypeName }}
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4">
            <label class="label">Съд издал акта</label>
            <div class="form-group display-input-container">
              {{ bulletinInfo.decidingAuthName }}
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Акт(№/дата)</label>
            <div class="form-group display-input-container">
              <span> {{ bulletinInfo.decisionNumber }} </span>
              <span> {{ bulletinInfo.decisionDate}} </span>         
            </div>
          </div>
          <div class="col-md-4">
            <label class="label">Дело(№/дата)</label>      
            <div class="form-group display-input-container">
              <span> {{ bulletinInfo.caseNumber }} </span>
              <span> {{ bulletinInfo.caseYear}} </span>         
            </div>
          </div>
        </div>
      </nb-card-body>
    </nb-card>
  </div>
</igx-dialog>
